{"changed":true,"filter":false,"title":"index.js","tooltip":"/routes/index.js","value":"var express = require('express');\nvar router = express.Router();\nvar passport = require('passport');\nvar config = require('../config');\nvar userService = require('../services/user-services');\nvar randomHelloGenerator = require('../services/random-hello-services');\n\n/* GET home page. */\nrouter.get('/', function(req, res, next) {\n    var data = {\n        user: false\n    };\n    if (req.user) {\n        req.user.helloMsg = randomHelloGenerator.genHelloMsg();\n        data.user = req.user;\n    }\n    res.render('index', data); //render home page\n});\n\nrouter.post('/login', function(req, res, next) {\n    if (req.body.rememberMe) {\n        req.session.cookie.maxAge = config.cookiesMaxAge;\n    }\n    next();\n}, function(req, res, next) {\n    passport.authenticate('local', function(err, user, info) {\n        if (err) {\n            return next(err);\n        }\n        if (!user) {\n            return res.json({\n                error: 'fail'\n            });\n        }\n        req.logIn(user, function(err) {\n            if (err) {\n                return next(err);\n            }\n            return res.json({\n                success: '/'\n            });\n        });\n    })(req, res, next);\n});\n\nrouter.get('/logout', function(req, res, next) {\n    req.logout();\n    res.json({\n        status: 'Bye!'\n    });\n});\n\nmodule.exports = router;","undoManager":{"mark":0,"position":1,"stack":[[{"start":{"row":48,"column":24},"end":{"row":49,"column":0},"action":"remove","lines":["",""],"id":30}],[{"start":{"row":16,"column":31},"end":{"row":16,"column":32},"action":"remove","lines":[" "],"id":31},{"start":{"row":20,"column":0},"end":{"row":20,"column":4},"action":"remove","lines":["    "]},{"start":{"row":21,"column":0},"end":{"row":21,"column":4},"action":"remove","lines":["    "]},{"start":{"row":22,"column":4},"end":{"row":22,"column":8},"action":"remove","lines":["    "]},{"start":{"row":23,"column":0},"end":{"row":23,"column":2},"action":"remove","lines":["  "]},{"start":{"row":23,"column":4},"end":{"row":23,"column":6},"action":"remove","lines":["  "]},{"start":{"row":24,"column":0},"end":{"row":24,"column":4},"action":"remove","lines":["    "]},{"start":{"row":38,"column":29},"end":{"row":39,"column":16},"action":"insert","lines":["","                "]},{"start":{"row":39,"column":28},"end":{"row":40,"column":12},"action":"insert","lines":["","            "]},{"start":{"row":47,"column":14},"end":{"row":48,"column":8},"action":"insert","lines":["","        "]},{"start":{"row":48,"column":15},"end":{"row":48,"column":16},"action":"insert","lines":[" "]},{"start":{"row":48,"column":22},"end":{"row":49,"column":4},"action":"insert","lines":["","    "]}]]},"ace":{"folds":[],"scrolltop":607,"scrollleft":0,"selection":{"start":{"row":18,"column":0},"end":{"row":18,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":6,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1462339450691}