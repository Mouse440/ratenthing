{"changed":true,"filter":false,"title":"posts.js","tooltip":"/routes/posts.js","value":"var express = require('express');\nvar router = express.Router();\nvar passport = require('passport');\nvar postService = require('../services/post-services');\nvar tagService = require('../services/tag-services');\nvar config = require('../config');\n\nrouter.get('/create', function(req, res, next) {\n    var data = {\n        title: \"Create Post\"\n    };\n    res.render('posts/create', data);\n});\n\nrouter.post('/like', function(req, res, next) {\n    \n});\n\nrouter.post('/create', function(req, res, next) {\n    tagService.findNewTag(req.body.tag, function(err, tag) {\n        console.log('dsadasdasd');\n        console.log(tag);\n        var new_tags = [];\n        tag.forEach(function(x) {\n            if(!isNaN(x)) {\n                new_tags.push(x);\n            }\n        });\n        if (err) {\n            console.log(\"{error: error}\");\n            return console.log(err);\n        }\n        tagService.addTag(req.body.tag, new_tags, function(err, num) {\n            if (err) {\n                console.log(err);\n                return console.log('{status : fail');\n            }\n            console.log('going next');\n            next();\n        });\n    });\n});\n\nrouter.post('/create', function(req, res, next) {\n    tagService.findTagId(req.body.tag, function(err, tag) {\n        if (err) {\n            return console.log(err);\n        }\n        console.log('{status: success}');\n        req.body.tag = tag;\n        next();\n    });\n});\n\nrouter.post('/create', function(req, res, next) {\n    req.body.author = req.user._id;\n    postService.addPost(req.body, function(err) {\n        if (err) {\n            console.log(err);\n            var data = {\n                title: \"Create a Post\",\n                info: req.body,\n                error: err\n            };\n            console.log('{status : fail}')\n            return res.json({fail: 'fail'});\n        }\n        console.log('success');\n        return res.json({\n            success: '/'\n        });\n    });\n});\n\nrouter.get('/allpost', function(req, res, next) {\n    postService.getPostAll(function(err, post) {\n        if (err) {\n            return console.log('{ status : failed }')\n        }\n        console.log('{ status : success }');\n        res.json({status : post});\n    });\n});\n\nrouter.get('/postbyid', function(req, res, next) {\n    postService.getPost(req.body, function(err, post) {\n        if (err) {\n            console.log('{ method : /userpost, status : fail }');\n            return console.log(err);\n        }\n        console.log('{ method : /userpost, status : pass }');\n        res.json({info : post});\n    });\n});\n\nrouter.get('/postbytag', function(req, res, next) {\n    postService.getPostByTag(req.body, function(err, post) {})\n});\n\nmodule.exports = router;\n","undoManager":{"mark":-15,"position":100,"stack":[[{"start":{"row":95,"column":13},"end":{"row":95,"column":14},"action":"insert","lines":["t"],"id":22111}],[{"start":{"row":95,"column":14},"end":{"row":95,"column":15},"action":"insert","lines":["a"],"id":22112}],[{"start":{"row":95,"column":15},"end":{"row":95,"column":16},"action":"insert","lines":["g"],"id":22113}],[{"start":{"row":95,"column":16},"end":{"row":95,"column":17},"action":"insert","lines":["p"],"id":22114}],[{"start":{"row":95,"column":17},"end":{"row":95,"column":18},"action":"insert","lines":["o"],"id":22115}],[{"start":{"row":95,"column":18},"end":{"row":95,"column":19},"action":"insert","lines":["s"],"id":22116}],[{"start":{"row":95,"column":19},"end":{"row":95,"column":20},"action":"insert","lines":["t"],"id":22117}],[{"start":{"row":95,"column":21},"end":{"row":95,"column":22},"action":"insert","lines":[","],"id":22118}],[{"start":{"row":95,"column":22},"end":{"row":95,"column":23},"action":"insert","lines":[" "],"id":22119}],[{"start":{"row":95,"column":23},"end":{"row":95,"column":24},"action":"insert","lines":["f"],"id":22120}],[{"start":{"row":95,"column":24},"end":{"row":95,"column":25},"action":"insert","lines":["u"],"id":22121}],[{"start":{"row":95,"column":25},"end":{"row":95,"column":26},"action":"insert","lines":["n"],"id":22122}],[{"start":{"row":95,"column":26},"end":{"row":95,"column":27},"action":"insert","lines":["c"],"id":22123}],[{"start":{"row":95,"column":27},"end":{"row":95,"column":28},"action":"insert","lines":["t"],"id":22124}],[{"start":{"row":95,"column":28},"end":{"row":95,"column":29},"action":"insert","lines":["i"],"id":22125}],[{"start":{"row":95,"column":29},"end":{"row":95,"column":30},"action":"insert","lines":["o"],"id":22126}],[{"start":{"row":95,"column":30},"end":{"row":95,"column":31},"action":"insert","lines":["n"],"id":22127}],[{"start":{"row":95,"column":23},"end":{"row":95,"column":31},"action":"remove","lines":["function"],"id":22128},{"start":{"row":95,"column":23},"end":{"row":97,"column":1},"action":"insert","lines":["function(req, res, next) {","    ","}"]}],[{"start":{"row":97,"column":2},"end":{"row":97,"column":3},"action":"insert","lines":[";"],"id":22129}],[{"start":{"row":97,"column":3},"end":{"row":98,"column":0},"action":"insert","lines":["",""],"id":22130}],[{"start":{"row":96,"column":4},"end":{"row":96,"column":5},"action":"insert","lines":["i"],"id":22131}],[{"start":{"row":96,"column":5},"end":{"row":96,"column":6},"action":"insert","lines":["f"],"id":22132}],[{"start":{"row":96,"column":5},"end":{"row":96,"column":6},"action":"remove","lines":["f"],"id":22133}],[{"start":{"row":96,"column":4},"end":{"row":96,"column":5},"action":"remove","lines":["i"],"id":22134}],[{"start":{"row":96,"column":4},"end":{"row":96,"column":5},"action":"insert","lines":["p"],"id":22135}],[{"start":{"row":96,"column":5},"end":{"row":96,"column":6},"action":"insert","lines":["o"],"id":22136}],[{"start":{"row":96,"column":6},"end":{"row":96,"column":7},"action":"insert","lines":["s"],"id":22137}],[{"start":{"row":96,"column":4},"end":{"row":96,"column":7},"action":"remove","lines":["pos"],"id":22138},{"start":{"row":96,"column":4},"end":{"row":96,"column":15},"action":"insert","lines":["postService"]}],[{"start":{"row":84,"column":13},"end":{"row":84,"column":21},"action":"remove","lines":["userpost"],"id":22139},{"start":{"row":84,"column":13},"end":{"row":84,"column":14},"action":"insert","lines":["p"]}],[{"start":{"row":84,"column":14},"end":{"row":84,"column":15},"action":"insert","lines":["o"],"id":22140}],[{"start":{"row":84,"column":15},"end":{"row":84,"column":16},"action":"insert","lines":["s"],"id":22141}],[{"start":{"row":84,"column":16},"end":{"row":84,"column":17},"action":"insert","lines":["t"],"id":22142}],[{"start":{"row":84,"column":17},"end":{"row":84,"column":18},"action":"insert","lines":["b"],"id":22143}],[{"start":{"row":84,"column":18},"end":{"row":84,"column":19},"action":"insert","lines":["y"],"id":22144}],[{"start":{"row":84,"column":19},"end":{"row":84,"column":20},"action":"insert","lines":["i"],"id":22145}],[{"start":{"row":84,"column":20},"end":{"row":84,"column":21},"action":"insert","lines":["d"],"id":22146}],[{"start":{"row":95,"column":13},"end":{"row":95,"column":20},"action":"remove","lines":["tagpost"],"id":22147},{"start":{"row":95,"column":13},"end":{"row":95,"column":14},"action":"insert","lines":["p"]}],[{"start":{"row":95,"column":14},"end":{"row":95,"column":15},"action":"insert","lines":["o"],"id":22148}],[{"start":{"row":95,"column":15},"end":{"row":95,"column":16},"action":"insert","lines":["s"],"id":22149}],[{"start":{"row":95,"column":16},"end":{"row":95,"column":17},"action":"insert","lines":["y"],"id":22150}],[{"start":{"row":95,"column":17},"end":{"row":95,"column":18},"action":"insert","lines":["b"],"id":22151}],[{"start":{"row":95,"column":18},"end":{"row":95,"column":19},"action":"insert","lines":["y"],"id":22152}],[{"start":{"row":95,"column":18},"end":{"row":95,"column":19},"action":"remove","lines":["y"],"id":22153}],[{"start":{"row":95,"column":17},"end":{"row":95,"column":18},"action":"remove","lines":["b"],"id":22154}],[{"start":{"row":95,"column":16},"end":{"row":95,"column":17},"action":"remove","lines":["y"],"id":22155}],[{"start":{"row":95,"column":16},"end":{"row":95,"column":17},"action":"insert","lines":["t"],"id":22156}],[{"start":{"row":95,"column":17},"end":{"row":95,"column":18},"action":"insert","lines":["b"],"id":22157}],[{"start":{"row":95,"column":18},"end":{"row":95,"column":19},"action":"insert","lines":["y"],"id":22158}],[{"start":{"row":95,"column":19},"end":{"row":95,"column":20},"action":"insert","lines":["t"],"id":22159}],[{"start":{"row":95,"column":20},"end":{"row":95,"column":21},"action":"insert","lines":["a"],"id":22160}],[{"start":{"row":95,"column":21},"end":{"row":95,"column":22},"action":"insert","lines":["g"],"id":22161}],[{"start":{"row":96,"column":15},"end":{"row":96,"column":16},"action":"insert","lines":["."],"id":22162}],[{"start":{"row":96,"column":16},"end":{"row":96,"column":17},"action":"insert","lines":["g"],"id":22163}],[{"start":{"row":96,"column":17},"end":{"row":96,"column":18},"action":"insert","lines":["e"],"id":22164}],[{"start":{"row":96,"column":18},"end":{"row":96,"column":19},"action":"insert","lines":["t"],"id":22165}],[{"start":{"row":96,"column":19},"end":{"row":96,"column":20},"action":"insert","lines":["P"],"id":22166}],[{"start":{"row":96,"column":20},"end":{"row":96,"column":21},"action":"insert","lines":["o"],"id":22167}],[{"start":{"row":96,"column":21},"end":{"row":96,"column":22},"action":"insert","lines":["s"],"id":22168}],[{"start":{"row":96,"column":22},"end":{"row":96,"column":23},"action":"insert","lines":["t"],"id":22169}],[{"start":{"row":96,"column":23},"end":{"row":96,"column":24},"action":"insert","lines":["T"],"id":22170}],[{"start":{"row":96,"column":23},"end":{"row":96,"column":24},"action":"remove","lines":["T"],"id":22171}],[{"start":{"row":96,"column":23},"end":{"row":96,"column":24},"action":"insert","lines":["B"],"id":22172}],[{"start":{"row":96,"column":24},"end":{"row":96,"column":25},"action":"insert","lines":["y"],"id":22173}],[{"start":{"row":96,"column":16},"end":{"row":96,"column":25},"action":"remove","lines":["getPostBy"],"id":22174},{"start":{"row":96,"column":16},"end":{"row":96,"column":28},"action":"insert","lines":["getPostByTag"]}],[{"start":{"row":96,"column":28},"end":{"row":96,"column":30},"action":"insert","lines":["()"],"id":22175}],[{"start":{"row":96,"column":29},"end":{"row":96,"column":30},"action":"insert","lines":["r"],"id":22176}],[{"start":{"row":96,"column":30},"end":{"row":96,"column":31},"action":"insert","lines":["e"],"id":22177}],[{"start":{"row":96,"column":31},"end":{"row":96,"column":32},"action":"insert","lines":["q"],"id":22178}],[{"start":{"row":96,"column":32},"end":{"row":96,"column":33},"action":"insert","lines":["."],"id":22179}],[{"start":{"row":96,"column":33},"end":{"row":96,"column":34},"action":"insert","lines":["b"],"id":22180}],[{"start":{"row":96,"column":34},"end":{"row":96,"column":35},"action":"insert","lines":["o"],"id":22181}],[{"start":{"row":96,"column":35},"end":{"row":96,"column":36},"action":"insert","lines":["d"],"id":22182}],[{"start":{"row":96,"column":36},"end":{"row":96,"column":37},"action":"insert","lines":["y"],"id":22183}],[{"start":{"row":96,"column":37},"end":{"row":96,"column":38},"action":"insert","lines":[","],"id":22184}],[{"start":{"row":96,"column":38},"end":{"row":96,"column":39},"action":"insert","lines":[" "],"id":22185}],[{"start":{"row":96,"column":39},"end":{"row":96,"column":40},"action":"insert","lines":["f"],"id":22186}],[{"start":{"row":96,"column":40},"end":{"row":96,"column":41},"action":"insert","lines":["u"],"id":22187}],[{"start":{"row":96,"column":41},"end":{"row":96,"column":42},"action":"insert","lines":["n"],"id":22188}],[{"start":{"row":96,"column":42},"end":{"row":96,"column":43},"action":"insert","lines":["c"],"id":22189}],[{"start":{"row":96,"column":43},"end":{"row":96,"column":44},"action":"insert","lines":["i"],"id":22190}],[{"start":{"row":96,"column":44},"end":{"row":96,"column":45},"action":"insert","lines":["o"],"id":22191}],[{"start":{"row":96,"column":45},"end":{"row":96,"column":46},"action":"insert","lines":["n"],"id":22192}],[{"start":{"row":96,"column":45},"end":{"row":96,"column":46},"action":"remove","lines":["n"],"id":22193}],[{"start":{"row":96,"column":44},"end":{"row":96,"column":45},"action":"remove","lines":["o"],"id":22194}],[{"start":{"row":96,"column":43},"end":{"row":96,"column":44},"action":"remove","lines":["i"],"id":22195}],[{"start":{"row":96,"column":43},"end":{"row":96,"column":44},"action":"insert","lines":["t"],"id":22196}],[{"start":{"row":96,"column":44},"end":{"row":96,"column":45},"action":"insert","lines":["i"],"id":22197}],[{"start":{"row":96,"column":45},"end":{"row":96,"column":46},"action":"insert","lines":["o"],"id":22198}],[{"start":{"row":96,"column":46},"end":{"row":96,"column":47},"action":"insert","lines":["n"],"id":22199}],[{"start":{"row":96,"column":47},"end":{"row":96,"column":49},"action":"insert","lines":["()"],"id":22200}],[{"start":{"row":96,"column":48},"end":{"row":96,"column":49},"action":"insert","lines":["e"],"id":22201}],[{"start":{"row":96,"column":49},"end":{"row":96,"column":50},"action":"insert","lines":["r"],"id":22202}],[{"start":{"row":96,"column":50},"end":{"row":96,"column":51},"action":"insert","lines":["r"],"id":22203}],[{"start":{"row":96,"column":51},"end":{"row":96,"column":52},"action":"insert","lines":[","],"id":22204}],[{"start":{"row":96,"column":52},"end":{"row":96,"column":53},"action":"insert","lines":[" "],"id":22205}],[{"start":{"row":96,"column":53},"end":{"row":96,"column":54},"action":"insert","lines":["p"],"id":22206}],[{"start":{"row":96,"column":54},"end":{"row":96,"column":55},"action":"insert","lines":["o"],"id":22207}],[{"start":{"row":96,"column":55},"end":{"row":96,"column":56},"action":"insert","lines":["s"],"id":22208}],[{"start":{"row":96,"column":56},"end":{"row":96,"column":57},"action":"insert","lines":["t"],"id":22209}],[{"start":{"row":96,"column":58},"end":{"row":96,"column":59},"action":"insert","lines":[" "],"id":22210}],[{"start":{"row":96,"column":59},"end":{"row":96,"column":61},"action":"insert","lines":["{}"],"id":22211}]]},"ace":{"folds":[],"scrolltop":1337.5,"scrollleft":0,"selection":{"start":{"row":96,"column":60},"end":{"row":96,"column":60},"isBackwards":false},"options":{"tabSize":4,"useSoftTabs":true,"guessTabSize":false,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":82,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1462338683604}